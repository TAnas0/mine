---
import { getCollection } from 'astro:content'
import { trimExcerpt } from '@/lib/utils'
import { template } from '@/settings'

interface Props {
	listTitle: string;
	listItems: {
		title: string;
		journal: string;
		time: string;
	}[];
}
const { listTitle, listItems } = Astro.props;

const page = {
	data: (await getCollection("blog")).map(post => ({
            title: post.data.title,
            date: post.data.date,
            badge: post.data.tags[0],
            excerpt: trimExcerpt(post.data.excerpt),
            slug: `${template.base}/blog/${post.id}`,
        }))
        .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime())
}
---

<h2 class="text-3xl font-bold mb-8">{listTitle}</h2>
	<div class='grid gap-8'>
		{
			page.data.map(post => (
				<article class='card bg-base-200 transition-all'>
					<div class='card-body'>
						<div class='flex justify-between items-start'>
							<h2 class='card-title text-xl'>
						<a href={post.slug} class='hover:text-accent'>
									{post.title}
								</a>
							</h2>
							<div class='badge badge-accent badge-outline p-4'>
								{post.badge}
							</div>
						</div>
						<time datetime={post.date} class='text-sm text-base-content/71'>
							{new Date(post.date).toLocaleDateString('en-US', {
								year: 'numeric',
								month: 'long',
								day: 'numeric',
							})}
						</time>
						<p class='mt-4'>{post.excerpt}</p>
						<div class='card-actions justify-end'>
							<a
						href={post.slug}
								class='btn btn-sm btn-secondary text-secondary-content'
							>
								Read More
							</a>
						</div>
					</div>
				</article>
			))
		}
	</div>
</div>
